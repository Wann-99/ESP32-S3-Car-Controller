# ESP32-S3 Car Blinker IoT 配置指南

## 📱 Blinker App 配置

### 1. 下载安装 Blinker App
- **Android**: 在应用商店搜索"点灯科技"或"Blinker"
- **iOS**: 在App Store搜索"Blinker"
- **官网下载**: https://www.diandeng.tech/home

### 2. 注册账号并添加设备
1. 打开Blinker App，注册新账号
2. 点击右上角"+"添加设备
3. 选择"独立设备" → "WiFi接入"
4. 输入设备名称（如：ESP32-S3 Car）
5. 复制生成的设备密钥（Secret Key）

### 3. 配置ESP32代码
将获取的设备密钥填入代码中：
```cpp
// 在ESP32-S3_Car.ino文件中找到以下行并修改
const char* auth = "你的Blinker设备密钥";
```

## 🎛️ 控件配置

### 必需控件配置

#### 1. 方向控制按钮
创建以下按钮控件：

| 控件名称 | 控件类型 | 数据键值 | 功能说明 |
|---------|---------|---------|----------|
| 前进 | Button | btn-forward | 小车前进 |
| 后退 | Button | btn-backward | 小车后退 |
| 左转 | Button | btn-left | 小车左转 |
| 右转 | Button | btn-right | 小车右转 |
| 左前 | Button | btn-leftforward | 小车左前斜移 |
| 右前 | Button | btn-rightforward | 小车右前斜移 |
| 左后 | Button | btn-leftbackward | 小车左后斜移 |
| 右后 | Button | btn-rightbackward | 小车右后斜移 |
| 停止 | Button | btn-stop | 停止运动 |

#### 2. 速度控制滑块
| 控件名称 | 控件类型 | 数据键值 | 范围 | 默认值 |
|---------|---------|---------|------|-------|
| 速度调节 | Slider | slider-speed | 0-255 | 150 |

#### 3. 舵机控制滑块
| 控件名称 | 控件类型 | 数据键值 | 范围 | 默认值 |
|---------|---------|---------|------|-------|
| 舵机角度 | Slider | slider-servo | 0-180 | 90 |

#### 4. 睡眠控制开关
| 控件名称 | 控件类型 | 数据键值 | 功能说明 |
|---------|---------|---------|----------|
| 睡眠模式 | Switch | btn-sleep | 进入/退出深度睡眠 |

#### 5. 状态显示文本
| 控件名称 | 控件类型 | 数据键值 | 显示内容 |
|---------|---------|---------|----------|
| 距离显示 | Text | text-distance | 超声波测距结果 |
| 速度显示 | Text | text-speed | 当前速度值 |
| 舵机角度 | Text | text-servo | 当前舵机角度 |

### 可选控件配置

#### 自动模式控制
| 控件名称 | 控件类型 | 数据键值 | 功能说明 |
|---------|---------|---------|----------|
| 自动模式 | Button | btn-auto | 开启/关闭自动避障 |

## 🎨 界面布局建议

### 推荐布局方案

```
┌─────────────────────────────────┐
│           状态显示区             │
│  距离: 25cm  速度: 150  角度: 90° │
├─────────────────────────────────┤
│           方向控制区             │
│     ↖  ↑  ↗                    │
│     ←  ⏸  →                    │
│     ↙  ↓  ↘                    │
├─────────────────────────────────┤
│           参数调节区             │
│  速度: ────●────── (0-255)      │
│  舵机: ────●────── (0-180°)     │
├─────────────────────────────────┤
│           功能控制区             │
│  [自动模式]    [睡眠模式]        │
└─────────────────────────────────┘
```

### 控件配置步骤

1. **添加按钮控件**
   - 点击编辑界面右上角"+"
   - 选择"按钮"控件
   - 设置数据键值（如：btn-forward）
   - 设置按钮文字和颜色
   - 调整按钮大小和位置

2. **添加滑块控件**
   - 选择"滑块"控件
   - 设置数据键值（如：slider-speed）
   - 设置数值范围和默认值
   - 选择滑块样式和颜色

3. **添加开关控件**
   - 选择"开关"控件
   - 设置数据键值（如：btn-sleep）
   - 选择开关样式

4. **添加文本控件**
   - 选择"文本"控件
   - 设置数据键值（如：text-distance）
   - 设置文本样式和字体大小

## 🔧 高级功能配置

### 语音控制配置
1. 在Blinker App中进入"语音助手"设置
2. 添加语音指令：
   - "小车前进" → 触发 btn-forward
   - "小车后退" → 触发 btn-backward
   - "小车停止" → 触发 btn-stop
   - "进入睡眠" → 触发 btn-sleep

### 定时任务配置
1. 在App中选择"定时"功能
2. 设置定时睡眠：
   - 时间：每天23:00
   - 动作：打开睡眠开关
3. 设置定时唤醒：
   - 时间：每天07:00
   - 动作：关闭睡眠开关（需手动按BOOT按钮唤醒）

### 场景模式配置
创建快捷场景：

#### 巡逻模式
- 开启自动模式
- 设置速度为100
- 舵机角度90°

#### 休眠模式
- 停止所有运动
- 打开睡眠开关
- 显示"系统休眠中..."

## 📊 数据监控

### 实时数据显示
系统会自动向Blinker发送以下数据：
- **距离数据**: 每100ms更新一次
- **速度数据**: 实时同步滑块值
- **舵机角度**: 实时同步滑块值
- **系统状态**: 运行/睡眠状态

### 历史数据查看
在Blinker App中可以查看：
- 距离变化曲线图
- 设备在线时长统计
- 控制指令历史记录

## 🔍 故障排除

### 常见问题

#### 1. 设备离线
**现象**: App显示设备离线
**解决方案**:
- 检查WiFi连接状态
- 确认设备密钥配置正确
- 重启ESP32设备
- 检查网络防火墙设置

#### 2. 控件无响应
**现象**: 点击按钮无反应
**解决方案**:
- 确认控件数据键值配置正确
- 检查ESP32串口输出是否有错误信息
- 重新配置控件并保存

#### 3. 数据显示异常
**现象**: 文本控件显示错误数据
**解决方案**:
- 检查传感器连接
- 确认数据键值匹配
- 重启设备重新连接

#### 4. 睡眠功能异常
**现象**: 无法进入或唤醒睡眠模式
**解决方案**:
- 确认GPIO0按钮连接正常
- 检查睡眠开关配置
- 查看串口输出的睡眠状态信息

### 调试技巧

1. **开启串口监视器**
   - 波特率设置为115200
   - 观察连接和控制日志

2. **使用Blinker调试模式**
   - 在App设置中开启调试模式
   - 查看数据传输日志

3. **网络连接测试**
   - 使用ping命令测试ESP32 IP连通性
   - 检查路由器DHCP分配情况

## 📞 技术支持

### 官方资源
- **Blinker官网**: https://www.diandeng.tech/
- **开发文档**: https://diandeng.tech/doc
- **社区论坛**: https://bbs.diandeng.tech/
- **GitHub**: https://github.com/blinker-iot

### 联系方式
- **技术QQ群**: 301438087
- **微信公众号**: 点灯科技
- **邮箱支持**: support@diandeng.tech

---

*最后更新: 2024-12-19*
*版本: v2.1.0*